<template>
    <require from="./components/buybook.html"></require>
    <require from="./components/sellbook.html"></require>
    <require from="./components/best-price.html"></require>
    <require from="./components/token-metrics"></require>

    <token-metrics token.bind="data"></token-metrics>

    <div class="container-fluid h100-minus-header">
        
        <div class="row exchange-columns h100">
            <div class="col-md-3 col-sm-12">
                <buybook loading.bind="loadingUserBuyBook" buy-book.bind="buyBook"></buybook>
                <best-price order.bind="bestSellPrice"></best-price>
                <sellbook loading.bind="loadingUserSellBook" sell-book.bind="sellBook"></sellbook>
            </div>

            <div class="col-md-6 col-sm-12 chart-col">
                <chart class="exchange-chart" data.bind="chartData"></chart>

                <div class="row">
                    <div class="col-md-6">
                        <h4 class="balances-heading">${'Balances' & t}</h4>

                        <div class="form-group">
                            <label class="balance-label d-block">${'STEEM' & t}(${'Pegged' & t}) <button type="button" class="btn-link float-right">${'Deposit' & t}</button></label>
                            <div class="input-group">
                                <input class="form-control form-control-dark text-right" type="text" placeholder="0.000" value.bind="steempBalance | comma" readonly>
                                <div class="input-group-append"><div class="input-group-text input-group-text-dark">${'STEEMP' & t}</div></div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="balance-label d-block">${data.name & t}</label>
                            <div class="input-group">
                                <input class="form-control form-control-dark text-right" type="text" placeholder="0.000" value.bind="tokenBalance" readonly>
                                <div class="input-group-append"><div class="input-group-text input-group-text-dark">${data.symbol & t}</div></div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="order-buttons">
                            <button type="button" class="btn btn-lg btn-buy" click.delegate="currentExchangeMode = 'buy'">${'Buy' & t}</button>
                            <button type="button" class="btn btn-lg btn-sell" click.delegate="currentExchangeMode = 'sell'">${'Sell' & t}</button>
                        </div>

                        <div class="form-group">
                            <label class="balance-label d-block">${'Price' & t}</label>
                            <div class="input-group">
                                <input class="form-control form-control-light text-right" type="text" placeholder.one-time="0.000" value.bind="bidPrice & validate">
                                <div class="input-group-append"><div class="input-group-text input-group-text-light">${'STEEMP' & t}</div></div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="balance-label d-block">${'Quantity' & t}</label>
                            <div class="input-group">
                                <input class="form-control form-control-light text-right" type="text" placeholder="0.000" value.bind="bidQuantity & validate">
                                <div class="input-group-append"><div class="input-group-text input-group-text-light">${data.symbol & t}</div></div>
                            </div>
                        </div>

                        <div class="form-group">
                            <div class="d-flex buy-percentage-buttons justify-space-between">
                                <button type="button" click.delegate="amountSelect(25)">25%</button>
                                <button type="button" click.delegate="amountSelect(50)">50%</button>
                                <button type="button" click.delegate="amountSelect(75)">75%</button>
                                <button type="button" click.delegate="amountSelect(100)">100%</button>
                            </div>
                        </div>

                        <div class="form-group">
                            <p>${totalMarketBalance}</p> ${'STEEMP' & t}
                        </div>

                        <div class="form-group">
                            <button type="button" class="btn ${currentExchangeMode == 'buy' ? 'btn-buy' : 'btn-sell'} btn-wide" click.delegate="confirmMarketOrder()">${currentExchangeMode == 'buy' ? 'Buy' : 'sell' & t}</button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-md-3 col-sm-12">
                <div class="history">
                        <table class="buy-table">
                            <thead>
                                <tr>
                                    <th width="135">${'Price' & t} (STEEMP)</th>
                                    <th>${'QTY' & t} (ENG)</th>
                                    <th>${'Time' & t}</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr repeat.for="trade of tradeHistory | slice:10">
                                    <td>${trade.price}</td>
                                    <td>${trade.quantity}</td>
                                    <td>${trade.timestamp_string}</td>
                                </tr>
                            </tbody>
                        </table>
                </div>
            </div>
        </div>
    </div>
</template>
