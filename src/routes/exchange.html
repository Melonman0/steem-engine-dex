<template>
    <header class="meta-header">
        <div class="container-fluid h100">
            <div class="h100 row align-items-center justify-content-between">
                <div class="col col-1 exchange-pair">${'STEEMP' & t}/${data.symbol}</div>
                <div class="col">
                    <div class="d-flex align-items-center justify-content-start">
                        <div class="meta-item">
                            <span class="meta-label">${'LAST PRICE' & t}: </span>
                            <span class="meta-value">${data.lastPrice} ${'STEEM'} / ${data.lastPrice | usdFormat:3}</span>
                        </div>
                        <div class="meta-item">
                            <span class="meta-label">${'24H' & t}: </span>
                            <span class="meta-value positive">+8.24%</span>
                        </div>
                        <div class="meta-item">
                            <span class="meta-label">${'HIGH' & t}: </span>
                            <span class="meta-value">${data.highestBid}</span>
                        </div>
                        <div class="meta-item">
                            <span class="meta-label">${'LOW' & t}: </span>
                            <span class="meta-value">${data.lowestAsk}</span>
                        </div>
                        <div class="meta-item">
                            <span class="meta-label">${'VOLUME' & t}: </span>
                            <span class="meta-value">${data.volume}</span>
                        </div>
                    </div>
                </div>
                <div class="col col-3 text-right">
                    <button type="button" class="outline-btn positive" click.delegate="deposit()">${'Deposit' & t}</button>
                    <button type="button" class="outline-btn negative" click.delegate="withdraw()">${'Withdraw' & t}</button>
                </div>
            </div>
        </div>
    </header>

    <div class="container-fluid h100-minus-header">
        
        <div class="row exchange-columns h100">
            <div class="col-md-3 col-sm-12">
                <div class="table-wrapper">
                    <loader loading.bind="loadingUserBuyBook" mode="tiny"></loader>
                    
                    <table class="buy-table">
                        <thead>
                            <tr>
                                <th width="135">${'Price' & t} (STEEMP)</th>
                                <th>${'QTY' & t} (ENG)</th>
                                <th>${'Total' & t} (STEEMP)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr repeat.for="order of sellBook | slice:10">
                                <td>${order.price}</td>
                                <td>${order.quantity}</td>
                                <td>${order.amountLocked | toFixed:6}</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="best-price" if.bind="bestSellPrice">
                    <div class="negative">${bestSellPrice.amountLocked} ${'STEEMP' & t}</div>
                    <div>${bestSellPrice.quantity} ${data.symbol}</div>
                </div>

                <div class="table-wrapper">
                    <loader loading.bind="loadingUserSellBook" mode="tiny"></loader>

                    <table class="sell-table">
                            <thead class="sr-only">
                                <tr>
                                    <th width="135">${'Price' & t} (STEEMP)</th>
                                    <th>${'QTY' & t} (ENG)</th>
                                    <th>${'Total' & t} (STEEMP)</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr repeat.for="order of buyBook | slice:10">
                                    <td>${order.price}</td>
                                    <td>${order.quantity}</td>
                                    <td>${order.amountLocked | toFixed:6}</td>
                                </tr>
                            </tbody>
                        </table>
                </div>
            </div>

            <div class="col-md-6 col-sm-12 chart-col">
                <chart class="exchange-chart" data.bind="chartData"></chart>

                <div class="row">
                    <div class="col-md-6">
                        <h4 class="balances-heading">${'Balances' & t}</h4>

                        <div class="form-group">
                            <label class="balance-label d-block">${'STEEM (Pegged)' & t} <button type="button" class="btn-link float-right">${'Deposit' & t}</button></label>
                            <div class="input-group">
                                <input class="form-control form-control-dark text-right" type="text" placeholder="0.000" value.bind="steempBalance | comma" readonly>
                                <div class="input-group-append"><div class="input-group-text input-group-text-dark">${'STEEMP' & t}</div></div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="balance-label d-block">${'Engine Token' & t}</label>
                            <div class="input-group">
                                <input class="form-control form-control-dark text-right" type="text" placeholder="0.000" value.bind="tokenBalance" readonly>
                                <div class="input-group-append"><div class="input-group-text input-group-text-dark">${data.symbol & t}</div></div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="order-buttons">
                            <button type="button" class="btn btn-lg btn-buy" click.delegate="currentExchangeMode = 'buy'">${'Buy' & t}</button>
                            <button type="button" class="btn btn-lg btn-sell" click.delegate="currentExchangeMode = 'sell'">${'Sell' & t}</button>
                        </div>

                        <div class="form-group">
                            <label class="balance-label d-block">${'Price' & t}</label>
                            <div class="input-group">
                                <input class="form-control form-control-light text-right" type="text" placeholder="0.000" value.bind="bidPrice">
                                <div class="input-group-append"><div class="input-group-text input-group-text-light">${'STEEMP' & t}</div></div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="balance-label d-block">${'Quantity' & t}</label>
                            <div class="input-group">
                                <input class="form-control form-control-light text-right" type="text" placeholder="0.000" value.bind="bidQuantity">
                                <div class="input-group-append"><div class="input-group-text input-group-text-light">${data.symbol & t}</div></div>
                            </div>
                        </div>

                        <div class="form-group">
                            <div class="d-flex buy-percentage-buttons justify-space-between">
                                <button type="button" click.delegate="amountSelect(25)">25%</button>
                                <button type="button" click.delegate="amountSelect(50)">50%</button>
                                <button type="button" click.delegate="amountSelect(75)">75%</button>
                                <button type="button" click.delegate="amountSelect(100)">100%</button>
                            </div>
                        </div>

                        <div class="form-group">
                            <button type="button" class="btn ${currentExchangeMode == 'buy' ? 'btn-buy' : 'btn-sell'} btn-wide" click.delegate="confirmMarketOrder()">${currentExchangeMode == 'buy' ? 'Buy' : 'sell' & t}</button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-md-3 col-sm-12">
                <div class="history">
                        <table class="buy-table">
                            <thead>
                                <tr>
                                    <th width="135">${'Price' & t} (STEEMP)</th>
                                    <th>${'QTY' & t} (ENG)</th>
                                    <th>${'Time' & t}</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr repeat.for="trade of tradeHistory | slice:10">
                                    <td>${trade.price}</td>
                                    <td>${trade.quantity}</td>
                                    <td>${trade.timestamp_string}</td>
                                </tr>
                            </tbody>
                        </table>
                </div>
            </div>
        </div>
    </div>
</template>
